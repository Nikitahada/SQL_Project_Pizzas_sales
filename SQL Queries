--created database to import csv files from pizza_sales.zip
create database pizza_hut;

--created tables to import big csv files (orders csv file is having data entries more than 10k)
create table orders (
order_id int not null,
order_date date not null,
order_time time not null,
primary key (order_id));

--created table to import csv file order_details(Having large data set)
create table order_details(
order_details_id int not null,
order_id int not null,
pizza_id text not null,
quantity int not null,
primary key (order_details_id));

--Retrieve the total number of orders placed
select count(order_id) as total_orders from orders;

--Calculate the total revenue generated from pizza sales.
select 
round(sum(od.quantity * p.price),2) as total_revenue
from order_details od
join pizzas p
on p.pizza_id = od.pizza_id

--Identify the highest-priced pizza
    select pt.name, p.price
    from pizza_types pt
    join pizzas p
    on pt.pizza_type_id = p.pizza_type_id
    order by p.price desc limit 1;

--Identify the most common pizza size ordered.
select
p.size, count(od.order_details_id) as order_count
from order_details od
join  pizzas p
on od.pizza_id = p.pizza_id
group by p.size order by order_count desc limit 1;

--List the top 5 most ordered pizza types
--along with their quantities


